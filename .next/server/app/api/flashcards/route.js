"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/flashcards/route";
exports.ids = ["app/api/flashcards/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = import("pg");;

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fflashcards%2Froute&page=%2Fapi%2Fflashcards%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fflashcards%2Froute.ts&appDir=%2FUsers%2Fsania%2FPORJECT%2FMemorizeAI%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsania%2FPORJECT%2FMemorizeAI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fflashcards%2Froute&page=%2Fapi%2Fflashcards%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fflashcards%2Froute.ts&appDir=%2FUsers%2Fsania%2FPORJECT%2FMemorizeAI%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsania%2FPORJECT%2FMemorizeAI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_sania_PORJECT_MemorizeAI_src_app_api_flashcards_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/flashcards/route.ts */ \"(rsc)/./src/app/api/flashcards/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_Users_sania_PORJECT_MemorizeAI_src_app_api_flashcards_route_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_Users_sania_PORJECT_MemorizeAI_src_app_api_flashcards_route_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/flashcards/route\",\n        pathname: \"/api/flashcards\",\n        filename: \"route\",\n        bundlePath: \"app/api/flashcards/route\"\n    },\n    resolvedPagePath: \"/Users/sania/PORJECT/MemorizeAI/src/app/api/flashcards/route.ts\",\n    nextConfigOutput,\n    userland: _Users_sania_PORJECT_MemorizeAI_src_app_api_flashcards_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/flashcards/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZmbGFzaGNhcmRzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZmbGFzaGNhcmRzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZmxhc2hjYXJkcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnNhbmlhJTJGUE9SSkVDVCUyRk1lbW9yaXplQUklMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGc2FuaWElMkZQT1JKRUNUJTJGTWVtb3JpemVBSSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDZTtBQUM1RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpdGVfcmVhY3Rfc2hhZGNuX3RzLz9iZTFlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9zYW5pYS9QT1JKRUNUL01lbW9yaXplQUkvc3JjL2FwcC9hcGkvZmxhc2hjYXJkcy9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZmxhc2hjYXJkcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2ZsYXNoY2FyZHNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2ZsYXNoY2FyZHMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvc2FuaWEvUE9SSkVDVC9NZW1vcml6ZUFJL3NyYy9hcHAvYXBpL2ZsYXNoY2FyZHMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2ZsYXNoY2FyZHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fflashcards%2Froute&page=%2Fapi%2Fflashcards%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fflashcards%2Froute.ts&appDir=%2FUsers%2Fsania%2FPORJECT%2FMemorizeAI%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsania%2FPORJECT%2FMemorizeAI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/flashcards/route.ts":
/*!*****************************************!*\
  !*** ./src/app/api/flashcards/route.ts ***!
  \*****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/ZodError.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_rag__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/rag */ \"(rsc)/./src/lib/rag.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_prisma__WEBPACK_IMPORTED_MODULE_1__, _lib_rag__WEBPACK_IMPORTED_MODULE_2__]);\n([_lib_prisma__WEBPACK_IMPORTED_MODULE_1__, _lib_rag__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\nconst requestSchema = zod__WEBPACK_IMPORTED_MODULE_3__.object({\n    documentId: zod__WEBPACK_IMPORTED_MODULE_3__.string().uuid(),\n    count: zod__WEBPACK_IMPORTED_MODULE_3__.number().int().min(1).max(12).optional()\n});\nasync function POST(request) {\n    try {\n        const payload = await request.json();\n        const { documentId, count } = requestSchema.parse(payload);\n        const document = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.document.findUnique({\n            where: {\n                id: documentId\n            }\n        });\n        if (!document) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Document not found\"\n            }, {\n                status: 404\n            });\n        }\n        const cards = await (0,_lib_rag__WEBPACK_IMPORTED_MODULE_2__.generateFlashcards)(documentId, count);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            flashcards: cards\n        });\n    } catch (error) {\n        if (error instanceof zod__WEBPACK_IMPORTED_MODULE_4__.ZodError) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid request\"\n            }, {\n                status: 400\n            });\n        }\n        const message = error instanceof Error ? error.message : \"Failed\";\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: message\n        }, {\n            status: 500\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9mbGFzaGNhcmRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUEyQztBQUNuQjtBQUNjO0FBQ1M7QUFFL0MsTUFBTUksZ0JBQWdCSCx1Q0FBUSxDQUFDO0lBQzdCSyxZQUFZTCx1Q0FBUSxHQUFHTyxJQUFJO0lBQzNCQyxPQUFPUix1Q0FBUSxHQUFHVSxHQUFHLEdBQUdDLEdBQUcsQ0FBQyxHQUFHQyxHQUFHLENBQUMsSUFBSUMsUUFBUTtBQUNqRDtBQUVPLGVBQWVDLEtBQUtDLE9BQWdCO0lBQ3pDLElBQUk7UUFDRixNQUFNQyxVQUFVLE1BQU1ELFFBQVFFLElBQUk7UUFDbEMsTUFBTSxFQUFFWixVQUFVLEVBQUVHLEtBQUssRUFBRSxHQUFHTCxjQUFjZSxLQUFLLENBQUNGO1FBRWxELE1BQU1HLFdBQVcsTUFBTWxCLCtDQUFNQSxDQUFDa0IsUUFBUSxDQUFDQyxVQUFVLENBQUM7WUFDaERDLE9BQU87Z0JBQUVDLElBQUlqQjtZQUFXO1FBQzFCO1FBRUEsSUFBSSxDQUFDYyxVQUFVO1lBQ2IsT0FBT3BCLHFEQUFZQSxDQUFDa0IsSUFBSSxDQUFDO2dCQUFFTSxPQUFPO1lBQXFCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUMxRTtRQUVBLE1BQU1DLFFBQVEsTUFBTXZCLDREQUFrQkEsQ0FBQ0csWUFBWUc7UUFDbkQsT0FBT1QscURBQVlBLENBQUNrQixJQUFJLENBQUM7WUFBRVMsWUFBWUQ7UUFBTTtJQUMvQyxFQUFFLE9BQU9GLE9BQU87UUFDZCxJQUFJQSxpQkFBaUJ2Qix5Q0FBVSxFQUFFO1lBQy9CLE9BQU9ELHFEQUFZQSxDQUFDa0IsSUFBSSxDQUFDO2dCQUFFTSxPQUFPO1lBQWtCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUN2RTtRQUNBLE1BQU1JLFVBQVVMLGlCQUFpQk0sUUFBUU4sTUFBTUssT0FBTyxHQUFHO1FBQ3pELE9BQU83QixxREFBWUEsQ0FBQ2tCLElBQUksQ0FBQztZQUFFTSxPQUFPSztRQUFRLEdBQUc7WUFBRUosUUFBUTtRQUFJO0lBQzdEO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aXRlX3JlYWN0X3NoYWRjbl90cy8uL3NyYy9hcHAvYXBpL2ZsYXNoY2FyZHMvcm91dGUudHM/MTY3YyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tIFwiQC9saWIvcHJpc21hXCI7XG5pbXBvcnQgeyBnZW5lcmF0ZUZsYXNoY2FyZHMgfSBmcm9tIFwiQC9saWIvcmFnXCI7XG5cbmNvbnN0IHJlcXVlc3RTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGRvY3VtZW50SWQ6IHouc3RyaW5nKCkudXVpZCgpLFxuICBjb3VudDogei5udW1iZXIoKS5pbnQoKS5taW4oMSkubWF4KDEyKS5vcHRpb25hbCgpXG59KTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBheWxvYWQgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCB7IGRvY3VtZW50SWQsIGNvdW50IH0gPSByZXF1ZXN0U2NoZW1hLnBhcnNlKHBheWxvYWQpO1xuXG4gICAgY29uc3QgZG9jdW1lbnQgPSBhd2FpdCBwcmlzbWEuZG9jdW1lbnQuZmluZFVuaXF1ZSh7XG4gICAgICB3aGVyZTogeyBpZDogZG9jdW1lbnRJZCB9XG4gICAgfSk7XG5cbiAgICBpZiAoIWRvY3VtZW50KSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJEb2N1bWVudCBub3QgZm91bmRcIiB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgIH1cblxuICAgIGNvbnN0IGNhcmRzID0gYXdhaXQgZ2VuZXJhdGVGbGFzaGNhcmRzKGRvY3VtZW50SWQsIGNvdW50KTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBmbGFzaGNhcmRzOiBjYXJkcyB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiB6LlpvZEVycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJJbnZhbGlkIHJlcXVlc3RcIiB9LCB7IHN0YXR1czogNDAwIH0pO1xuICAgIH1cbiAgICBjb25zdCBtZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIkZhaWxlZFwiO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBtZXNzYWdlIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJ6IiwicHJpc21hIiwiZ2VuZXJhdGVGbGFzaGNhcmRzIiwicmVxdWVzdFNjaGVtYSIsIm9iamVjdCIsImRvY3VtZW50SWQiLCJzdHJpbmciLCJ1dWlkIiwiY291bnQiLCJudW1iZXIiLCJpbnQiLCJtaW4iLCJtYXgiLCJvcHRpb25hbCIsIlBPU1QiLCJyZXF1ZXN0IiwicGF5bG9hZCIsImpzb24iLCJwYXJzZSIsImRvY3VtZW50IiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiaWQiLCJlcnJvciIsInN0YXR1cyIsImNhcmRzIiwiZmxhc2hjYXJkcyIsIlpvZEVycm9yIiwibWVzc2FnZSIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/flashcards/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/ai.ts":
/*!***********************!*\
  !*** ./src/lib/ai.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createChatClient: () => (/* binding */ createChatClient),\n/* harmony export */   createEmbeddingsClient: () => (/* binding */ createEmbeddingsClient)\n/* harmony export */ });\n/* harmony import */ var _langchain_openai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @langchain/openai */ \"(rsc)/./node_modules/@langchain/openai/index.js\");\n/* harmony import */ var _lib_env__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/env */ \"(rsc)/./src/lib/env.ts\");\n\n\nfunction createEmbeddingsClient() {\n    return new _langchain_openai__WEBPACK_IMPORTED_MODULE_0__.OpenAIEmbeddings({\n        apiKey: _lib_env__WEBPACK_IMPORTED_MODULE_1__.env.openaiApiKey,\n        model: _lib_env__WEBPACK_IMPORTED_MODULE_1__.env.embeddingModel\n    });\n}\nfunction createChatClient() {\n    return new _langchain_openai__WEBPACK_IMPORTED_MODULE_0__.ChatOpenAI({\n        apiKey: _lib_env__WEBPACK_IMPORTED_MODULE_1__.env.openaiApiKey,\n        model: _lib_env__WEBPACK_IMPORTED_MODULE_1__.env.chatModel,\n        temperature: 0\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FpLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBaUU7QUFDakM7QUFFekIsU0FBU0c7SUFDZCxPQUFPLElBQUlGLCtEQUFnQkEsQ0FBQztRQUMxQkcsUUFBUUYseUNBQUdBLENBQUNHLFlBQVk7UUFDeEJDLE9BQU9KLHlDQUFHQSxDQUFDSyxjQUFjO0lBQzNCO0FBQ0Y7QUFFTyxTQUFTQztJQUNkLE9BQU8sSUFBSVIseURBQVVBLENBQUM7UUFDcEJJLFFBQVFGLHlDQUFHQSxDQUFDRyxZQUFZO1FBQ3hCQyxPQUFPSix5Q0FBR0EsQ0FBQ08sU0FBUztRQUNwQkMsYUFBYTtJQUNmO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aXRlX3JlYWN0X3NoYWRjbl90cy8uL3NyYy9saWIvYWkudHM/ZGEyOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDaGF0T3BlbkFJLCBPcGVuQUlFbWJlZGRpbmdzIH0gZnJvbSBcIkBsYW5nY2hhaW4vb3BlbmFpXCI7XG5pbXBvcnQgeyBlbnYgfSBmcm9tIFwiQC9saWIvZW52XCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbWJlZGRpbmdzQ2xpZW50KCkge1xuICByZXR1cm4gbmV3IE9wZW5BSUVtYmVkZGluZ3Moe1xuICAgIGFwaUtleTogZW52Lm9wZW5haUFwaUtleSxcbiAgICBtb2RlbDogZW52LmVtYmVkZGluZ01vZGVsXG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2hhdENsaWVudCgpIHtcbiAgcmV0dXJuIG5ldyBDaGF0T3BlbkFJKHtcbiAgICBhcGlLZXk6IGVudi5vcGVuYWlBcGlLZXksXG4gICAgbW9kZWw6IGVudi5jaGF0TW9kZWwsXG4gICAgdGVtcGVyYXR1cmU6IDBcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsiQ2hhdE9wZW5BSSIsIk9wZW5BSUVtYmVkZGluZ3MiLCJlbnYiLCJjcmVhdGVFbWJlZGRpbmdzQ2xpZW50IiwiYXBpS2V5Iiwib3BlbmFpQXBpS2V5IiwibW9kZWwiLCJlbWJlZGRpbmdNb2RlbCIsImNyZWF0ZUNoYXRDbGllbnQiLCJjaGF0TW9kZWwiLCJ0ZW1wZXJhdHVyZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/ai.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/env.ts":
/*!************************!*\
  !*** ./src/lib/env.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assertEnv: () => (/* binding */ assertEnv),\n/* harmony export */   env: () => (/* binding */ env)\n/* harmony export */ });\nconst env = {\n    databaseUrl: process.env.DATABASE_URL ?? \"\",\n    openaiApiKey: process.env.OPENAI_API_KEY ?? \"\",\n    inngestEventKey: process.env.INNGEST_EVENT_KEY ?? \"\",\n    inngestSigningKey: process.env.INNGEST_SIGNING_KEY ?? \"\",\n    chunkSize: Number(process.env.CHUNK_SIZE ?? 1000),\n    chunkOverlap: Number(process.env.CHUNK_OVERLAP ?? 150),\n    uploadMaxBytes: Number(process.env.UPLOAD_MAX_BYTES ?? 20000000),\n    embeddingModel: process.env.EMBEDDING_MODEL ?? \"text-embedding-3-small\",\n    chatModel: process.env.CHAT_MODEL ?? \"gpt-4o-mini\",\n    topK: Number(process.env.TOP_K ?? 5)\n};\nfunction assertEnv() {\n    const missing = [];\n    if (!env.databaseUrl) missing.push(\"DATABASE_URL\");\n    if (!env.openaiApiKey) missing.push(\"OPENAI_API_KEY\");\n    if (missing.length) {\n        throw new Error(`Missing required env vars: ${missing.join(\", \")}`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2Vudi50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFPLE1BQU1BLE1BQU07SUFDakJDLGFBQWFDLFFBQVFGLEdBQUcsQ0FBQ0csWUFBWSxJQUFJO0lBQ3pDQyxjQUFjRixRQUFRRixHQUFHLENBQUNLLGNBQWMsSUFBSTtJQUM1Q0MsaUJBQWlCSixRQUFRRixHQUFHLENBQUNPLGlCQUFpQixJQUFJO0lBQ2xEQyxtQkFBbUJOLFFBQVFGLEdBQUcsQ0FBQ1MsbUJBQW1CLElBQUk7SUFDdERDLFdBQVdDLE9BQU9ULFFBQVFGLEdBQUcsQ0FBQ1ksVUFBVSxJQUFJO0lBQzVDQyxjQUFjRixPQUFPVCxRQUFRRixHQUFHLENBQUNjLGFBQWEsSUFBSTtJQUNsREMsZ0JBQWdCSixPQUFPVCxRQUFRRixHQUFHLENBQUNnQixnQkFBZ0IsSUFBSTtJQUN2REMsZ0JBQWdCZixRQUFRRixHQUFHLENBQUNrQixlQUFlLElBQUk7SUFDL0NDLFdBQVdqQixRQUFRRixHQUFHLENBQUNvQixVQUFVLElBQUk7SUFDckNDLE1BQU1WLE9BQU9ULFFBQVFGLEdBQUcsQ0FBQ3NCLEtBQUssSUFBSTtBQUNwQyxFQUFFO0FBRUssU0FBU0M7SUFDZCxNQUFNQyxVQUFvQixFQUFFO0lBQzVCLElBQUksQ0FBQ3hCLElBQUlDLFdBQVcsRUFBRXVCLFFBQVFDLElBQUksQ0FBQztJQUNuQyxJQUFJLENBQUN6QixJQUFJSSxZQUFZLEVBQUVvQixRQUFRQyxJQUFJLENBQUM7SUFDcEMsSUFBSUQsUUFBUUUsTUFBTSxFQUFFO1FBQ2xCLE1BQU0sSUFBSUMsTUFBTSxDQUFDLDJCQUEyQixFQUFFSCxRQUFRSSxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ3BFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aXRlX3JlYWN0X3NoYWRjbl90cy8uL3NyYy9saWIvZW52LnRzPzg0ODUiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGVudiA9IHtcbiAgZGF0YWJhc2VVcmw6IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCA/PyBcIlwiLFxuICBvcGVuYWlBcGlLZXk6IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZID8/IFwiXCIsXG4gIGlubmdlc3RFdmVudEtleTogcHJvY2Vzcy5lbnYuSU5OR0VTVF9FVkVOVF9LRVkgPz8gXCJcIixcbiAgaW5uZ2VzdFNpZ25pbmdLZXk6IHByb2Nlc3MuZW52LklOTkdFU1RfU0lHTklOR19LRVkgPz8gXCJcIixcbiAgY2h1bmtTaXplOiBOdW1iZXIocHJvY2Vzcy5lbnYuQ0hVTktfU0laRSA/PyAxMDAwKSxcbiAgY2h1bmtPdmVybGFwOiBOdW1iZXIocHJvY2Vzcy5lbnYuQ0hVTktfT1ZFUkxBUCA/PyAxNTApLFxuICB1cGxvYWRNYXhCeXRlczogTnVtYmVyKHByb2Nlc3MuZW52LlVQTE9BRF9NQVhfQllURVMgPz8gMjBfMDAwXzAwMCksXG4gIGVtYmVkZGluZ01vZGVsOiBwcm9jZXNzLmVudi5FTUJFRERJTkdfTU9ERUwgPz8gXCJ0ZXh0LWVtYmVkZGluZy0zLXNtYWxsXCIsXG4gIGNoYXRNb2RlbDogcHJvY2Vzcy5lbnYuQ0hBVF9NT0RFTCA/PyBcImdwdC00by1taW5pXCIsXG4gIHRvcEs6IE51bWJlcihwcm9jZXNzLmVudi5UT1BfSyA/PyA1KVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydEVudigpIHtcbiAgY29uc3QgbWlzc2luZzogc3RyaW5nW10gPSBbXTtcbiAgaWYgKCFlbnYuZGF0YWJhc2VVcmwpIG1pc3NpbmcucHVzaChcIkRBVEFCQVNFX1VSTFwiKTtcbiAgaWYgKCFlbnYub3BlbmFpQXBpS2V5KSBtaXNzaW5nLnB1c2goXCJPUEVOQUlfQVBJX0tFWVwiKTtcbiAgaWYgKG1pc3NpbmcubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIHJlcXVpcmVkIGVudiB2YXJzOiAke21pc3Npbmcuam9pbihcIiwgXCIpfWApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiZW52IiwiZGF0YWJhc2VVcmwiLCJwcm9jZXNzIiwiREFUQUJBU0VfVVJMIiwib3BlbmFpQXBpS2V5IiwiT1BFTkFJX0FQSV9LRVkiLCJpbm5nZXN0RXZlbnRLZXkiLCJJTk5HRVNUX0VWRU5UX0tFWSIsImlubmdlc3RTaWduaW5nS2V5IiwiSU5OR0VTVF9TSUdOSU5HX0tFWSIsImNodW5rU2l6ZSIsIk51bWJlciIsIkNIVU5LX1NJWkUiLCJjaHVua092ZXJsYXAiLCJDSFVOS19PVkVSTEFQIiwidXBsb2FkTWF4Qnl0ZXMiLCJVUExPQURfTUFYX0JZVEVTIiwiZW1iZWRkaW5nTW9kZWwiLCJFTUJFRERJTkdfTU9ERUwiLCJjaGF0TW9kZWwiLCJDSEFUX01PREVMIiwidG9wSyIsIlRPUF9LIiwiYXNzZXJ0RW52IiwibWlzc2luZyIsInB1c2giLCJsZW5ndGgiLCJFcnJvciIsImpvaW4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/env.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _prisma_adapter_pg__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @prisma/adapter-pg */ \"(rsc)/./node_modules/@prisma/adapter-pg/dist/index.mjs\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var _lib_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/env */ \"(rsc)/./src/lib/env.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([pg__WEBPACK_IMPORTED_MODULE_1__, _prisma_adapter_pg__WEBPACK_IMPORTED_MODULE_3__]);\n([pg__WEBPACK_IMPORTED_MODULE_1__, _prisma_adapter_pg__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\nconst globalForPrisma = globalThis;\nfunction createPrismaClient() {\n    (0,_lib_env__WEBPACK_IMPORTED_MODULE_2__.assertEnv)();\n    const pool = new pg__WEBPACK_IMPORTED_MODULE_1__.Pool({\n        connectionString: _lib_env__WEBPACK_IMPORTED_MODULE_2__.env.databaseUrl\n    });\n    const adapter = new _prisma_adapter_pg__WEBPACK_IMPORTED_MODULE_3__.PrismaPg(pool);\n    return new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n        adapter\n    });\n}\nconst prisma = createPrismaClient();\nif (true) {\n    globalForPrisma.prisma = prisma;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBOEM7QUFDQTtBQUNwQjtBQUNpQjtBQUUzQyxNQUFNSyxrQkFBa0JDO0FBRXhCLFNBQVNDO0lBQ1BKLG1EQUFTQTtJQUNULE1BQU1LLE9BQU8sSUFBSU4sb0NBQUlBLENBQUM7UUFDcEJPLGtCQUFrQkwseUNBQUdBLENBQUNNLFdBQVc7SUFDbkM7SUFDQSxNQUFNQyxVQUFVLElBQUlWLHdEQUFRQSxDQUFDTztJQUM3QixPQUFPLElBQUlSLHdEQUFZQSxDQUFDO1FBQUVXO0lBQVE7QUFDcEM7QUFFTyxNQUFNQyxTQUFTTCxxQkFBcUI7QUFFM0MsSUFBSU0sSUFBcUMsRUFBRTtJQUN6Q1IsZ0JBQWdCTyxNQUFNLEdBQUdBO0FBQzNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdml0ZV9yZWFjdF9zaGFkY25fdHMvLi9zcmMvbGliL3ByaXNtYS50cz8wMWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gXCJAcHJpc21hL2NsaWVudFwiO1xuaW1wb3J0IHsgUHJpc21hUGcgfSBmcm9tIFwiQHByaXNtYS9hZGFwdGVyLXBnXCI7XG5pbXBvcnQgeyBQb29sIH0gZnJvbSBcInBnXCI7XG5pbXBvcnQgeyBhc3NlcnRFbnYsIGVudiB9IGZyb20gXCJAL2xpYi9lbnZcIjtcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHsgcHJpc21hPzogUHJpc21hQ2xpZW50IH07XG5cbmZ1bmN0aW9uIGNyZWF0ZVByaXNtYUNsaWVudCgpIHtcbiAgYXNzZXJ0RW52KCk7XG4gIGNvbnN0IHBvb2wgPSBuZXcgUG9vbCh7XG4gICAgY29ubmVjdGlvblN0cmluZzogZW52LmRhdGFiYXNlVXJsXG4gIH0pO1xuICBjb25zdCBhZGFwdGVyID0gbmV3IFByaXNtYVBnKHBvb2wpO1xuICByZXR1cm4gbmV3IFByaXNtYUNsaWVudCh7IGFkYXB0ZXIgfSk7XG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSBjcmVhdGVQcmlzbWFDbGllbnQoKTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hO1xufVxuIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsIlByaXNtYVBnIiwiUG9vbCIsImFzc2VydEVudiIsImVudiIsImdsb2JhbEZvclByaXNtYSIsImdsb2JhbFRoaXMiLCJjcmVhdGVQcmlzbWFDbGllbnQiLCJwb29sIiwiY29ubmVjdGlvblN0cmluZyIsImRhdGFiYXNlVXJsIiwiYWRhcHRlciIsInByaXNtYSIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/rag.ts":
/*!************************!*\
  !*** ./src/lib/rag.ts ***!
  \************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   answerQuestion: () => (/* binding */ answerQuestion),\n/* harmony export */   generateFlashcards: () => (/* binding */ generateFlashcards),\n/* harmony export */   retrieveChunks: () => (/* binding */ retrieveChunks)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_ai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/ai */ \"(rsc)/./src/lib/ai.ts\");\n/* harmony import */ var _lib_env__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/env */ \"(rsc)/./src/lib/env.ts\");\n/* harmony import */ var _lib_retry__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/retry */ \"(rsc)/./src/lib/retry.ts\");\n/* harmony import */ var _lib_vector__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/vector */ \"(rsc)/./src/lib/vector.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_prisma__WEBPACK_IMPORTED_MODULE_1__]);\n_lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\nconst SYSTEM_PROMPT = `You are a QA assistant for PDF documents.\nUse ONLY the provided sources. If the answer is not fully contained in the sources, say \"I don't know\".\nReturn JSON with keys: answer (string) and citations (array of {chunkId, pageStart, pageEnd, snippet}).\nCitations must quote short snippets from the sources.`;\nfunction normalizeText(text) {\n    return text.replace(/\\s+/g, \" \").trim();\n}\nasync function retrieveChunks(documentId, query) {\n    (0,_lib_env__WEBPACK_IMPORTED_MODULE_3__.assertEnv)();\n    const embeddings = (0,_lib_ai__WEBPACK_IMPORTED_MODULE_2__.createEmbeddingsClient)();\n    const queryEmbedding = await (0,_lib_retry__WEBPACK_IMPORTED_MODULE_4__.withRetries)(()=>embeddings.embedQuery(query), {\n        retries: 3\n    });\n    const vector = (0,_lib_vector__WEBPACK_IMPORTED_MODULE_5__.toPgVector)(queryEmbedding);\n    const rows = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.$queryRaw(_prisma_client__WEBPACK_IMPORTED_MODULE_0__.Prisma.sql`\n    SELECT \"id\", \"content\", \"pageStart\", \"pageEnd\"\n    FROM \"Chunk\"\n    WHERE \"documentId\" = ${documentId}\n      AND \"embedding\" IS NOT NULL\n    ORDER BY \"embedding\" <=> ${_prisma_client__WEBPACK_IMPORTED_MODULE_0__.Prisma.raw(`'${vector}'::vector`)}\n    LIMIT ${_lib_env__WEBPACK_IMPORTED_MODULE_3__.env.topK}\n  `);\n    return rows;\n}\nfunction extractPageNumber(question) {\n    const match = question.match(/page\\\\s+(\\\\d+)/i);\n    if (!match) return null;\n    const page = Number(match[1]);\n    return Number.isFinite(page) ? page : null;\n}\nasync function retrieveChunksForQuestion(documentId, question) {\n    const page = extractPageNumber(question);\n    if (page !== null) {\n        const rows = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.$queryRaw(_prisma_client__WEBPACK_IMPORTED_MODULE_0__.Prisma.sql`\n      SELECT \"id\", \"content\", \"pageStart\", \"pageEnd\"\n      FROM \"Chunk\"\n      WHERE \"documentId\" = ${documentId}\n        AND \"pageStart\" IS NOT NULL\n        AND (\"pageStart\" = ${page} OR \"pageEnd\" = ${page} OR (\"pageStart\" <= ${page} AND \"pageEnd\" >= ${page}))\n      ORDER BY \"pageStart\" ASC\n      LIMIT ${_lib_env__WEBPACK_IMPORTED_MODULE_3__.env.topK}\n    `);\n        if (rows.length) return rows;\n    }\n    return retrieveChunks(documentId, question);\n}\nasync function answerQuestion(documentId, question) {\n    const page = extractPageNumber(question);\n    const chunks = await retrieveChunksForQuestion(documentId, question);\n    if (!chunks.length) {\n        return {\n            answer: \"I don't know\",\n            citations: []\n        };\n    }\n    if (page !== null) {\n        const citations = chunks.slice(0, Math.min(3, chunks.length)).map((chunk)=>({\n                chunkId: chunk.id,\n                pageStart: chunk.pageStart ?? null,\n                pageEnd: chunk.pageEnd ?? null,\n                snippet: chunk.content.slice(0, 200)\n            }));\n        const answer = `Here are excerpts from page ${page}:\\n` + citations.map((c)=>`- ${c.snippet}`).join(\"\\n\");\n        return {\n            answer,\n            citations\n        };\n    }\n    const chunkMap = new Map(chunks.map((chunk)=>[\n            chunk.id,\n            {\n                content: chunk.content,\n                pageStart: chunk.pageStart,\n                pageEnd: chunk.pageEnd\n            }\n        ]));\n    const sources = chunks.map((chunk)=>({\n            id: chunk.id,\n            pageStart: chunk.pageStart,\n            pageEnd: chunk.pageEnd,\n            text: chunk.content\n        }));\n    const chat = (0,_lib_ai__WEBPACK_IMPORTED_MODULE_2__.createChatClient)();\n    const response = await (0,_lib_retry__WEBPACK_IMPORTED_MODULE_4__.withRetries)(()=>chat.invoke([\n            {\n                role: \"system\",\n                content: SYSTEM_PROMPT\n            },\n            {\n                role: \"user\",\n                content: `Question: ${question}\\nSources: ${JSON.stringify(sources)}`\n            }\n        ]), {\n        retries: 2\n    });\n    const raw = response.content?.toString() ?? \"\";\n    try {\n        const parsed = JSON.parse(raw);\n        if (typeof parsed.answer !== \"string\" || !Array.isArray(parsed.citations)) {\n            throw new Error(\"Invalid model response\");\n        }\n        const citations = parsed.citations.filter((citation)=>{\n            if (!citation?.chunkId || !citation?.snippet) return false;\n            const source = chunkMap.get(citation.chunkId);\n            if (!source) return false;\n            return source.content.includes(citation.snippet);\n        }).map((citation)=>{\n            const source = chunkMap.get(citation.chunkId);\n            return {\n                chunkId: citation.chunkId,\n                pageStart: source.pageStart ?? null,\n                pageEnd: source.pageEnd ?? null,\n                snippet: citation.snippet\n            };\n        });\n        if (!citations.length || parsed.answer.trim() === \"\") {\n            return {\n                answer: \"I don't know\",\n                citations: []\n            };\n        }\n        return {\n            answer: parsed.answer,\n            citations\n        };\n    } catch (error) {\n        return {\n            answer: \"I don't know\",\n            citations: []\n        };\n    }\n}\nconst FLASHCARD_PROMPT = `You create study flashcards from sources only.\nReturn JSON with key \"flashcards\": array of objects:\n{ id, question, answer, chunkId, snippet }.\nThe answer must be an exact quote from the source chunk.\nThe snippet must be a short quote from the same chunk.\nUse only chunkId values provided in sources.`;\nasync function generateFlashcards(documentId, count = 6) {\n    (0,_lib_env__WEBPACK_IMPORTED_MODULE_3__.assertEnv)();\n    const query = \"key concepts, definitions, and important facts\";\n    const chunks = await retrieveChunks(documentId, query);\n    if (!chunks.length) return [];\n    const chunkMap = new Map(chunks.map((chunk)=>[\n            chunk.id,\n            {\n                content: chunk.content,\n                pageStart: chunk.pageStart,\n                pageEnd: chunk.pageEnd\n            }\n        ]));\n    const sources = chunks.map((chunk)=>({\n            id: chunk.id,\n            text: chunk.content\n        }));\n    const chat = (0,_lib_ai__WEBPACK_IMPORTED_MODULE_2__.createChatClient)();\n    const response = await (0,_lib_retry__WEBPACK_IMPORTED_MODULE_4__.withRetries)(()=>chat.invoke([\n            {\n                role: \"system\",\n                content: FLASHCARD_PROMPT\n            },\n            {\n                role: \"user\",\n                content: `Create up to ${count} flashcards. Sources: ${JSON.stringify(sources)}`\n            }\n        ]), {\n        retries: 2\n    });\n    const raw = response.content?.toString() ?? \"\";\n    let cleaned = [];\n    try {\n        const parsed = JSON.parse(raw);\n        const cards = parsed.flashcards ?? [];\n        const seen = new Set();\n        for (const card of cards){\n            if (!card?.chunkId || !card?.question) continue;\n            const source = chunkMap.get(card.chunkId);\n            if (!source) continue;\n            const sourceNorm = normalizeText(source.content);\n            let answer = card.answer ?? \"\";\n            let snippet = card.snippet ?? \"\";\n            const answerNorm = normalizeText(answer);\n            const snippetNorm = normalizeText(snippet);\n            if (answer && snippet && !sourceNorm.includes(answerNorm) && sourceNorm.includes(snippetNorm)) {\n                answer = snippet;\n            }\n            if (!answer && snippet && sourceNorm.includes(snippetNorm)) {\n                answer = snippet;\n            }\n            if (!snippet && answer && sourceNorm.includes(answerNorm)) {\n                snippet = answer;\n            }\n            if (!answer || !snippet) continue;\n            if (!sourceNorm.includes(normalizeText(answer))) continue;\n            if (!sourceNorm.includes(normalizeText(snippet))) continue;\n            const key = `${card.chunkId}:${normalizeText(answer)}`;\n            if (seen.has(key)) continue;\n            seen.add(key);\n            cleaned.push({\n                id: card.id ?? card.chunkId,\n                question: card.question,\n                answer,\n                chunkId: card.chunkId,\n                pageStart: source.pageStart ?? null,\n                pageEnd: source.pageEnd ?? null,\n                snippet\n            });\n        }\n    } catch  {\n        cleaned = [];\n    }\n    if (cleaned.length) return cleaned.slice(0, count);\n    const fallback = [];\n    for (const chunk of chunks.slice(0, count)){\n        const source = chunkMap.get(chunk.id);\n        if (!source) continue;\n        const text = normalizeText(source.content);\n        if (!text) continue;\n        const snippet = text.slice(0, 160);\n        const words = snippet.split(\" \").slice(0, 8).join(\" \");\n        fallback.push({\n            id: chunk.id,\n            question: `What does the document say about \"${words}\"?`,\n            answer: snippet,\n            chunkId: chunk.id,\n            pageStart: source.pageStart ?? null,\n            pageEnd: source.pageEnd ?? null,\n            snippet\n        });\n    }\n    return fallback;\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU9ELGNBQWMyRCxPQUFPcEIsT0FBTztRQUN6QyxJQUFJLENBQUN0QyxNQUFNO1FBQ1gsTUFBTXFDLFVBQVVyQyxLQUFLNEIsS0FBSyxDQUFDLEdBQUc7UUFDOUIsTUFBTW1ELFFBQVExQyxRQUFRMkMsS0FBSyxDQUFDLEtBQUtwRCxLQUFLLENBQUMsR0FBRyxHQUFHWSxJQUFJLENBQUM7UUFDbERzQyxTQUFTRCxJQUFJLENBQUM7WUFDWjNDLElBQUlGLE1BQU1FLEVBQUU7WUFDWmpCLFVBQVUsQ0FBQyxrQ0FBa0MsRUFBRThELE1BQU0sRUFBRSxDQUFDO1lBQ3hEckQsUUFBUVc7WUFDUkosU0FBU0QsTUFBTUUsRUFBRTtZQUNqQkMsV0FBV3VCLE9BQU92QixTQUFTLElBQUk7WUFDL0JDLFNBQVNzQixPQUFPdEIsT0FBTyxJQUFJO1lBQzNCQztRQUNGO0lBQ0Y7SUFFQSxPQUFPeUM7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpdGVfcmVhY3Rfc2hhZGNuX3RzLy4vc3JjL2xpYi9yYWcudHM/ZjVlMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQcmlzbWEgfSBmcm9tIFwiQHByaXNtYS9jbGllbnRcIjtcbmltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcbmltcG9ydCB7IGNyZWF0ZUNoYXRDbGllbnQsIGNyZWF0ZUVtYmVkZGluZ3NDbGllbnQgfSBmcm9tIFwiQC9saWIvYWlcIjtcbmltcG9ydCB7IGFzc2VydEVudiwgZW52IH0gZnJvbSBcIkAvbGliL2VudlwiO1xuaW1wb3J0IHsgd2l0aFJldHJpZXMgfSBmcm9tIFwiQC9saWIvcmV0cnlcIjtcbmltcG9ydCB7IHRvUGdWZWN0b3IgfSBmcm9tIFwiQC9saWIvdmVjdG9yXCI7XG5cbmNvbnN0IFNZU1RFTV9QUk9NUFQgPSBgWW91IGFyZSBhIFFBIGFzc2lzdGFudCBmb3IgUERGIGRvY3VtZW50cy5cblVzZSBPTkxZIHRoZSBwcm92aWRlZCBzb3VyY2VzLiBJZiB0aGUgYW5zd2VyIGlzIG5vdCBmdWxseSBjb250YWluZWQgaW4gdGhlIHNvdXJjZXMsIHNheSBcIkkgZG9uJ3Qga25vd1wiLlxuUmV0dXJuIEpTT04gd2l0aCBrZXlzOiBhbnN3ZXIgKHN0cmluZykgYW5kIGNpdGF0aW9ucyAoYXJyYXkgb2Yge2NodW5rSWQsIHBhZ2VTdGFydCwgcGFnZUVuZCwgc25pcHBldH0pLlxuQ2l0YXRpb25zIG11c3QgcXVvdGUgc2hvcnQgc25pcHBldHMgZnJvbSB0aGUgc291cmNlcy5gO1xuXG5leHBvcnQgdHlwZSBSZXRyaWV2ZWRDaHVuayA9IHtcbiAgaWQ6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBwYWdlU3RhcnQ6IG51bWJlciB8IG51bGw7XG4gIHBhZ2VFbmQ6IG51bWJlciB8IG51bGw7XG59O1xuXG5leHBvcnQgdHlwZSBGbGFzaGNhcmQgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIHF1ZXN0aW9uOiBzdHJpbmc7XG4gIGFuc3dlcjogc3RyaW5nO1xuICBjaHVua0lkOiBzdHJpbmc7XG4gIHBhZ2VTdGFydDogbnVtYmVyIHwgbnVsbDtcbiAgcGFnZUVuZDogbnVtYmVyIHwgbnVsbDtcbiAgc25pcHBldDogc3RyaW5nO1xufTtcblxuZnVuY3Rpb24gbm9ybWFsaXplVGV4dCh0ZXh0OiBzdHJpbmcpIHtcbiAgcmV0dXJuIHRleHQucmVwbGFjZSgvXFxzKy9nLCBcIiBcIikudHJpbSgpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmV0cmlldmVDaHVua3MoZG9jdW1lbnRJZDogc3RyaW5nLCBxdWVyeTogc3RyaW5nKSB7XG4gIGFzc2VydEVudigpO1xuICBjb25zdCBlbWJlZGRpbmdzID0gY3JlYXRlRW1iZWRkaW5nc0NsaWVudCgpO1xuICBjb25zdCBxdWVyeUVtYmVkZGluZyA9IGF3YWl0IHdpdGhSZXRyaWVzKFxuICAgICgpID0+IGVtYmVkZGluZ3MuZW1iZWRRdWVyeShxdWVyeSksXG4gICAgeyByZXRyaWVzOiAzIH1cbiAgKTtcbiAgY29uc3QgdmVjdG9yID0gdG9QZ1ZlY3RvcihxdWVyeUVtYmVkZGluZyk7XG5cbiAgY29uc3Qgcm93cyA9IGF3YWl0IHByaXNtYS4kcXVlcnlSYXc8UmV0cmlldmVkQ2h1bmtbXT4oUHJpc21hLnNxbGBcbiAgICBTRUxFQ1QgXCJpZFwiLCBcImNvbnRlbnRcIiwgXCJwYWdlU3RhcnRcIiwgXCJwYWdlRW5kXCJcbiAgICBGUk9NIFwiQ2h1bmtcIlxuICAgIFdIRVJFIFwiZG9jdW1lbnRJZFwiID0gJHtkb2N1bWVudElkfVxuICAgICAgQU5EIFwiZW1iZWRkaW5nXCIgSVMgTk9UIE5VTExcbiAgICBPUkRFUiBCWSBcImVtYmVkZGluZ1wiIDw9PiAke1ByaXNtYS5yYXcoYCcke3ZlY3Rvcn0nOjp2ZWN0b3JgKX1cbiAgICBMSU1JVCAke2Vudi50b3BLfVxuICBgKTtcblxuICByZXR1cm4gcm93cztcbn1cblxuZnVuY3Rpb24gZXh0cmFjdFBhZ2VOdW1iZXIocXVlc3Rpb246IHN0cmluZykge1xuICBjb25zdCBtYXRjaCA9IHF1ZXN0aW9uLm1hdGNoKC9wYWdlXFxcXHMrKFxcXFxkKykvaSk7XG4gIGlmICghbWF0Y2gpIHJldHVybiBudWxsO1xuICBjb25zdCBwYWdlID0gTnVtYmVyKG1hdGNoWzFdKTtcbiAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShwYWdlKSA/IHBhZ2UgOiBudWxsO1xufVxuXG5hc3luYyBmdW5jdGlvbiByZXRyaWV2ZUNodW5rc0ZvclF1ZXN0aW9uKGRvY3VtZW50SWQ6IHN0cmluZywgcXVlc3Rpb246IHN0cmluZykge1xuICBjb25zdCBwYWdlID0gZXh0cmFjdFBhZ2VOdW1iZXIocXVlc3Rpb24pO1xuICBpZiAocGFnZSAhPT0gbnVsbCkge1xuICAgIGNvbnN0IHJvd3MgPSBhd2FpdCBwcmlzbWEuJHF1ZXJ5UmF3PFJldHJpZXZlZENodW5rW10+KFByaXNtYS5zcWxgXG4gICAgICBTRUxFQ1QgXCJpZFwiLCBcImNvbnRlbnRcIiwgXCJwYWdlU3RhcnRcIiwgXCJwYWdlRW5kXCJcbiAgICAgIEZST00gXCJDaHVua1wiXG4gICAgICBXSEVSRSBcImRvY3VtZW50SWRcIiA9ICR7ZG9jdW1lbnRJZH1cbiAgICAgICAgQU5EIFwicGFnZVN0YXJ0XCIgSVMgTk9UIE5VTExcbiAgICAgICAgQU5EIChcInBhZ2VTdGFydFwiID0gJHtwYWdlfSBPUiBcInBhZ2VFbmRcIiA9ICR7cGFnZX0gT1IgKFwicGFnZVN0YXJ0XCIgPD0gJHtwYWdlfSBBTkQgXCJwYWdlRW5kXCIgPj0gJHtwYWdlfSkpXG4gICAgICBPUkRFUiBCWSBcInBhZ2VTdGFydFwiIEFTQ1xuICAgICAgTElNSVQgJHtlbnYudG9wS31cbiAgICBgKTtcbiAgICBpZiAocm93cy5sZW5ndGgpIHJldHVybiByb3dzO1xuICB9XG5cbiAgcmV0dXJuIHJldHJpZXZlQ2h1bmtzKGRvY3VtZW50SWQsIHF1ZXN0aW9uKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFuc3dlclF1ZXN0aW9uKGRvY3VtZW50SWQ6IHN0cmluZywgcXVlc3Rpb246IHN0cmluZykge1xuICBjb25zdCBwYWdlID0gZXh0cmFjdFBhZ2VOdW1iZXIocXVlc3Rpb24pO1xuICBjb25zdCBjaHVua3MgPSBhd2FpdCByZXRyaWV2ZUNodW5rc0ZvclF1ZXN0aW9uKGRvY3VtZW50SWQsIHF1ZXN0aW9uKTtcbiAgaWYgKCFjaHVua3MubGVuZ3RoKSB7XG4gICAgcmV0dXJuIHsgYW5zd2VyOiBcIkkgZG9uJ3Qga25vd1wiLCBjaXRhdGlvbnM6IFtdIH07XG4gIH1cblxuICBpZiAocGFnZSAhPT0gbnVsbCkge1xuICAgIGNvbnN0IGNpdGF0aW9ucyA9IGNodW5rcy5zbGljZSgwLCBNYXRoLm1pbigzLCBjaHVua3MubGVuZ3RoKSkubWFwKChjaHVuaykgPT4gKHtcbiAgICAgIGNodW5rSWQ6IGNodW5rLmlkLFxuICAgICAgcGFnZVN0YXJ0OiBjaHVuay5wYWdlU3RhcnQgPz8gbnVsbCxcbiAgICAgIHBhZ2VFbmQ6IGNodW5rLnBhZ2VFbmQgPz8gbnVsbCxcbiAgICAgIHNuaXBwZXQ6IGNodW5rLmNvbnRlbnQuc2xpY2UoMCwgMjAwKVxuICAgIH0pKTtcbiAgICBjb25zdCBhbnN3ZXIgPSBgSGVyZSBhcmUgZXhjZXJwdHMgZnJvbSBwYWdlICR7cGFnZX06XFxuYCArXG4gICAgICBjaXRhdGlvbnMubWFwKChjKSA9PiBgLSAke2Muc25pcHBldH1gKS5qb2luKFwiXFxuXCIpO1xuICAgIHJldHVybiB7IGFuc3dlciwgY2l0YXRpb25zIH07XG4gIH1cblxuICBjb25zdCBjaHVua01hcCA9IG5ldyBNYXAoXG4gICAgY2h1bmtzLm1hcCgoY2h1bmspID0+IFtcbiAgICAgIGNodW5rLmlkLFxuICAgICAgeyBjb250ZW50OiBjaHVuay5jb250ZW50LCBwYWdlU3RhcnQ6IGNodW5rLnBhZ2VTdGFydCwgcGFnZUVuZDogY2h1bmsucGFnZUVuZCB9XG4gICAgXSlcbiAgKTtcblxuICBjb25zdCBzb3VyY2VzID0gY2h1bmtzLm1hcCgoY2h1bmspID0+ICh7XG4gICAgaWQ6IGNodW5rLmlkLFxuICAgIHBhZ2VTdGFydDogY2h1bmsucGFnZVN0YXJ0LFxuICAgIHBhZ2VFbmQ6IGNodW5rLnBhZ2VFbmQsXG4gICAgdGV4dDogY2h1bmsuY29udGVudFxuICB9KSk7XG5cbiAgY29uc3QgY2hhdCA9IGNyZWF0ZUNoYXRDbGllbnQoKTtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3aXRoUmV0cmllcyhcbiAgICAoKSA9PlxuICAgICAgY2hhdC5pbnZva2UoW1xuICAgICAgICB7IHJvbGU6IFwic3lzdGVtXCIsIGNvbnRlbnQ6IFNZU1RFTV9QUk9NUFQgfSxcbiAgICAgICAge1xuICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxuICAgICAgICAgIGNvbnRlbnQ6IGBRdWVzdGlvbjogJHtxdWVzdGlvbn1cXG5Tb3VyY2VzOiAke0pTT04uc3RyaW5naWZ5KHNvdXJjZXMpfWBcbiAgICAgICAgfVxuICAgICAgXSksXG4gICAgeyByZXRyaWVzOiAyIH1cbiAgKTtcblxuICBjb25zdCByYXcgPSByZXNwb25zZS5jb250ZW50Py50b1N0cmluZygpID8/IFwiXCI7XG4gIHRyeSB7XG4gICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShyYXcpO1xuICAgIGlmICh0eXBlb2YgcGFyc2VkLmFuc3dlciAhPT0gXCJzdHJpbmdcIiB8fCAhQXJyYXkuaXNBcnJheShwYXJzZWQuY2l0YXRpb25zKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBtb2RlbCByZXNwb25zZVwiKTtcbiAgICB9XG4gICAgY29uc3QgY2l0YXRpb25zID0gcGFyc2VkLmNpdGF0aW9uc1xuICAgICAgLmZpbHRlcigoY2l0YXRpb246IHsgY2h1bmtJZD86IHN0cmluZzsgc25pcHBldD86IHN0cmluZyB9KSA9PiB7XG4gICAgICAgIGlmICghY2l0YXRpb24/LmNodW5rSWQgfHwgIWNpdGF0aW9uPy5zbmlwcGV0KSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGNvbnN0IHNvdXJjZSA9IGNodW5rTWFwLmdldChjaXRhdGlvbi5jaHVua0lkKTtcbiAgICAgICAgaWYgKCFzb3VyY2UpIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHNvdXJjZS5jb250ZW50LmluY2x1ZGVzKGNpdGF0aW9uLnNuaXBwZXQpO1xuICAgICAgfSlcbiAgICAgIC5tYXAoKGNpdGF0aW9uOiB7IGNodW5rSWQ6IHN0cmluZzsgc25pcHBldDogc3RyaW5nIH0pID0+IHtcbiAgICAgICAgY29uc3Qgc291cmNlID0gY2h1bmtNYXAuZ2V0KGNpdGF0aW9uLmNodW5rSWQpITtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjaHVua0lkOiBjaXRhdGlvbi5jaHVua0lkLFxuICAgICAgICAgIHBhZ2VTdGFydDogc291cmNlLnBhZ2VTdGFydCA/PyBudWxsLFxuICAgICAgICAgIHBhZ2VFbmQ6IHNvdXJjZS5wYWdlRW5kID8/IG51bGwsXG4gICAgICAgICAgc25pcHBldDogY2l0YXRpb24uc25pcHBldFxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICBpZiAoIWNpdGF0aW9ucy5sZW5ndGggfHwgcGFyc2VkLmFuc3dlci50cmltKCkgPT09IFwiXCIpIHtcbiAgICAgIHJldHVybiB7IGFuc3dlcjogXCJJIGRvbid0IGtub3dcIiwgY2l0YXRpb25zOiBbXSB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IGFuc3dlcjogcGFyc2VkLmFuc3dlciwgY2l0YXRpb25zIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFuc3dlcjogXCJJIGRvbid0IGtub3dcIixcbiAgICAgIGNpdGF0aW9uczogW11cbiAgICB9O1xuICB9XG59XG5cbmNvbnN0IEZMQVNIQ0FSRF9QUk9NUFQgPSBgWW91IGNyZWF0ZSBzdHVkeSBmbGFzaGNhcmRzIGZyb20gc291cmNlcyBvbmx5LlxuUmV0dXJuIEpTT04gd2l0aCBrZXkgXCJmbGFzaGNhcmRzXCI6IGFycmF5IG9mIG9iamVjdHM6XG57IGlkLCBxdWVzdGlvbiwgYW5zd2VyLCBjaHVua0lkLCBzbmlwcGV0IH0uXG5UaGUgYW5zd2VyIG11c3QgYmUgYW4gZXhhY3QgcXVvdGUgZnJvbSB0aGUgc291cmNlIGNodW5rLlxuVGhlIHNuaXBwZXQgbXVzdCBiZSBhIHNob3J0IHF1b3RlIGZyb20gdGhlIHNhbWUgY2h1bmsuXG5Vc2Ugb25seSBjaHVua0lkIHZhbHVlcyBwcm92aWRlZCBpbiBzb3VyY2VzLmA7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUZsYXNoY2FyZHMoZG9jdW1lbnRJZDogc3RyaW5nLCBjb3VudCA9IDYpIHtcbiAgYXNzZXJ0RW52KCk7XG4gIGNvbnN0IHF1ZXJ5ID0gXCJrZXkgY29uY2VwdHMsIGRlZmluaXRpb25zLCBhbmQgaW1wb3J0YW50IGZhY3RzXCI7XG4gIGNvbnN0IGNodW5rcyA9IGF3YWl0IHJldHJpZXZlQ2h1bmtzKGRvY3VtZW50SWQsIHF1ZXJ5KTtcbiAgaWYgKCFjaHVua3MubGVuZ3RoKSByZXR1cm4gW107XG5cbiAgY29uc3QgY2h1bmtNYXAgPSBuZXcgTWFwKFxuICAgIGNodW5rcy5tYXAoKGNodW5rKSA9PiBbXG4gICAgICBjaHVuay5pZCxcbiAgICAgIHsgY29udGVudDogY2h1bmsuY29udGVudCwgcGFnZVN0YXJ0OiBjaHVuay5wYWdlU3RhcnQsIHBhZ2VFbmQ6IGNodW5rLnBhZ2VFbmQgfVxuICAgIF0pXG4gICk7XG5cbiAgY29uc3Qgc291cmNlcyA9IGNodW5rcy5tYXAoKGNodW5rKSA9PiAoe1xuICAgIGlkOiBjaHVuay5pZCxcbiAgICB0ZXh0OiBjaHVuay5jb250ZW50XG4gIH0pKTtcblxuICBjb25zdCBjaGF0ID0gY3JlYXRlQ2hhdENsaWVudCgpO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHdpdGhSZXRyaWVzKFxuICAgICgpID0+XG4gICAgICBjaGF0Lmludm9rZShbXG4gICAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogRkxBU0hDQVJEX1BST01QVCB9LFxuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogXCJ1c2VyXCIsXG4gICAgICAgICAgY29udGVudDogYENyZWF0ZSB1cCB0byAke2NvdW50fSBmbGFzaGNhcmRzLiBTb3VyY2VzOiAke0pTT04uc3RyaW5naWZ5KHNvdXJjZXMpfWBcbiAgICAgICAgfVxuICAgICAgXSksXG4gICAgeyByZXRyaWVzOiAyIH1cbiAgKTtcblxuICBjb25zdCByYXcgPSByZXNwb25zZS5jb250ZW50Py50b1N0cmluZygpID8/IFwiXCI7XG4gIGxldCBjbGVhbmVkOiBGbGFzaGNhcmRbXSA9IFtdO1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2UocmF3KSBhcyB7IGZsYXNoY2FyZHM/OiBBcnJheTxSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+PiB9O1xuICAgIGNvbnN0IGNhcmRzID0gcGFyc2VkLmZsYXNoY2FyZHMgPz8gW107XG4gICAgY29uc3Qgc2VlbiA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXG4gICAgZm9yIChjb25zdCBjYXJkIG9mIGNhcmRzKSB7XG4gICAgICBpZiAoIWNhcmQ/LmNodW5rSWQgfHwgIWNhcmQ/LnF1ZXN0aW9uKSBjb250aW51ZTtcbiAgICAgIGNvbnN0IHNvdXJjZSA9IGNodW5rTWFwLmdldChjYXJkLmNodW5rSWQpO1xuICAgICAgaWYgKCFzb3VyY2UpIGNvbnRpbnVlO1xuICAgICAgY29uc3Qgc291cmNlTm9ybSA9IG5vcm1hbGl6ZVRleHQoc291cmNlLmNvbnRlbnQpO1xuICAgICAgbGV0IGFuc3dlciA9IGNhcmQuYW5zd2VyID8/IFwiXCI7XG4gICAgICBsZXQgc25pcHBldCA9IGNhcmQuc25pcHBldCA/PyBcIlwiO1xuICAgICAgY29uc3QgYW5zd2VyTm9ybSA9IG5vcm1hbGl6ZVRleHQoYW5zd2VyKTtcbiAgICAgIGNvbnN0IHNuaXBwZXROb3JtID0gbm9ybWFsaXplVGV4dChzbmlwcGV0KTtcblxuICAgICAgaWYgKGFuc3dlciAmJiBzbmlwcGV0ICYmICFzb3VyY2VOb3JtLmluY2x1ZGVzKGFuc3dlck5vcm0pICYmIHNvdXJjZU5vcm0uaW5jbHVkZXMoc25pcHBldE5vcm0pKSB7XG4gICAgICAgIGFuc3dlciA9IHNuaXBwZXQ7XG4gICAgICB9XG4gICAgICBpZiAoIWFuc3dlciAmJiBzbmlwcGV0ICYmIHNvdXJjZU5vcm0uaW5jbHVkZXMoc25pcHBldE5vcm0pKSB7XG4gICAgICAgIGFuc3dlciA9IHNuaXBwZXQ7XG4gICAgICB9XG4gICAgICBpZiAoIXNuaXBwZXQgJiYgYW5zd2VyICYmIHNvdXJjZU5vcm0uaW5jbHVkZXMoYW5zd2VyTm9ybSkpIHtcbiAgICAgICAgc25pcHBldCA9IGFuc3dlcjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFhbnN3ZXIgfHwgIXNuaXBwZXQpIGNvbnRpbnVlO1xuICAgICAgaWYgKCFzb3VyY2VOb3JtLmluY2x1ZGVzKG5vcm1hbGl6ZVRleHQoYW5zd2VyKSkpIGNvbnRpbnVlO1xuICAgICAgaWYgKCFzb3VyY2VOb3JtLmluY2x1ZGVzKG5vcm1hbGl6ZVRleHQoc25pcHBldCkpKSBjb250aW51ZTtcbiAgICAgIGNvbnN0IGtleSA9IGAke2NhcmQuY2h1bmtJZH06JHtub3JtYWxpemVUZXh0KGFuc3dlcil9YDtcbiAgICAgIGlmIChzZWVuLmhhcyhrZXkpKSBjb250aW51ZTtcbiAgICAgIHNlZW4uYWRkKGtleSk7XG4gICAgICBjbGVhbmVkLnB1c2goe1xuICAgICAgICBpZDogY2FyZC5pZCA/PyBjYXJkLmNodW5rSWQsXG4gICAgICAgIHF1ZXN0aW9uOiBjYXJkLnF1ZXN0aW9uLFxuICAgICAgICBhbnN3ZXIsXG4gICAgICAgIGNodW5rSWQ6IGNhcmQuY2h1bmtJZCxcbiAgICAgICAgcGFnZVN0YXJ0OiBzb3VyY2UucGFnZVN0YXJ0ID8/IG51bGwsXG4gICAgICAgIHBhZ2VFbmQ6IHNvdXJjZS5wYWdlRW5kID8/IG51bGwsXG4gICAgICAgIHNuaXBwZXRcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBjYXRjaCB7XG4gICAgY2xlYW5lZCA9IFtdO1xuICB9XG5cbiAgaWYgKGNsZWFuZWQubGVuZ3RoKSByZXR1cm4gY2xlYW5lZC5zbGljZSgwLCBjb3VudCk7XG5cbiAgY29uc3QgZmFsbGJhY2s6IEZsYXNoY2FyZFtdID0gW107XG4gIGZvciAoY29uc3QgY2h1bmsgb2YgY2h1bmtzLnNsaWNlKDAsIGNvdW50KSkge1xuICAgIGNvbnN0IHNvdXJjZSA9IGNodW5rTWFwLmdldChjaHVuay5pZCk7XG4gICAgaWYgKCFzb3VyY2UpIGNvbnRpbnVlO1xuICAgIGNvbnN0IHRleHQgPSBub3JtYWxpemVUZXh0KHNvdXJjZS5jb250ZW50KTtcbiAgICBpZiAoIXRleHQpIGNvbnRpbnVlO1xuICAgIGNvbnN0IHNuaXBwZXQgPSB0ZXh0LnNsaWNlKDAsIDE2MCk7XG4gICAgY29uc3Qgd29yZHMgPSBzbmlwcGV0LnNwbGl0KFwiIFwiKS5zbGljZSgwLCA4KS5qb2luKFwiIFwiKTtcbiAgICBmYWxsYmFjay5wdXNoKHtcbiAgICAgIGlkOiBjaHVuay5pZCxcbiAgICAgIHF1ZXN0aW9uOiBgV2hhdCBkb2VzIHRoZSBkb2N1bWVudCBzYXkgYWJvdXQgXCIke3dvcmRzfVwiP2AsXG4gICAgICBhbnN3ZXI6IHNuaXBwZXQsXG4gICAgICBjaHVua0lkOiBjaHVuay5pZCxcbiAgICAgIHBhZ2VTdGFydDogc291cmNlLnBhZ2VTdGFydCA/PyBudWxsLFxuICAgICAgcGFnZUVuZDogc291cmNlLnBhZ2VFbmQgPz8gbnVsbCxcbiAgICAgIHNuaXBwZXRcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBmYWxsYmFjaztcbn1cbiJdLCJuYW1lcyI6WyJQcmlzbWEiLCJwcmlzbWEiLCJjcmVhdGVDaGF0Q2xpZW50IiwiY3JlYXRlRW1iZWRkaW5nc0NsaWVudCIsImFzc2VydEVudiIsImVudiIsIndpdGhSZXRyaWVzIiwidG9QZ1ZlY3RvciIsIlNZU1RFTV9QUk9NUFQiLCJub3JtYWxpemVUZXh0IiwidGV4dCIsInJlcGxhY2UiLCJ0cmltIiwicmV0cmlldmVDaHVua3MiLCJkb2N1bWVudElkIiwicXVlcnkiLCJlbWJlZGRpbmdzIiwicXVlcnlFbWJlZGRpbmciLCJlbWJlZFF1ZXJ5IiwicmV0cmllcyIsInZlY3RvciIsInJvd3MiLCIkcXVlcnlSYXciLCJzcWwiLCJyYXciLCJ0b3BLIiwiZXh0cmFjdFBhZ2VOdW1iZXIiLCJxdWVzdGlvbiIsIm1hdGNoIiwicGFnZSIsIk51bWJlciIsImlzRmluaXRlIiwicmV0cmlldmVDaHVua3NGb3JRdWVzdGlvbiIsImxlbmd0aCIsImFuc3dlclF1ZXN0aW9uIiwiY2h1bmtzIiwiYW5zd2VyIiwiY2l0YXRpb25zIiwic2xpY2UiLCJNYXRoIiwibWluIiwibWFwIiwiY2h1bmsiLCJjaHVua0lkIiwiaWQiLCJwYWdlU3RhcnQiLCJwYWdlRW5kIiwic25pcHBldCIsImNvbnRlbnQiLCJjIiwiam9pbiIsImNodW5rTWFwIiwiTWFwIiwic291cmNlcyIsImNoYXQiLCJyZXNwb25zZSIsImludm9rZSIsInJvbGUiLCJKU09OIiwic3RyaW5naWZ5IiwidG9TdHJpbmciLCJwYXJzZWQiLCJwYXJzZSIsIkFycmF5IiwiaXNBcnJheSIsIkVycm9yIiwiZmlsdGVyIiwiY2l0YXRpb24iLCJzb3VyY2UiLCJnZXQiLCJpbmNsdWRlcyIsImVycm9yIiwiRkxBU0hDQVJEX1BST01QVCIsImdlbmVyYXRlRmxhc2hjYXJkcyIsImNvdW50IiwiY2xlYW5lZCIsImNhcmRzIiwiZmxhc2hjYXJkcyIsInNlZW4iLCJTZXQiLCJjYXJkIiwic291cmNlTm9ybSIsImFuc3dlck5vcm0iLCJzbmlwcGV0Tm9ybSIsImtleSIsImhhcyIsImFkZCIsInB1c2giLCJmYWxsYmFjayIsIndvcmRzIiwic3BsaXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/rag.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/retry.ts":
/*!**************************!*\
  !*** ./src/lib/retry.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   withRetries: () => (/* binding */ withRetries)\n/* harmony export */ });\nasync function withRetries(operation, options = {\n    retries: 3,\n    baseDelayMs: 500\n}) {\n    const { retries, baseDelayMs = 500 } = options;\n    let lastError;\n    for(let attempt = 0; attempt <= retries; attempt += 1){\n        try {\n            return await operation();\n        } catch (error) {\n            lastError = error;\n            if (attempt === retries) break;\n            const delay = baseDelayMs * Math.pow(2, attempt);\n            await new Promise((resolve)=>setTimeout(resolve, delay));\n        }\n    }\n    throw lastError;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3JldHJ5LnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBTyxlQUFlQSxZQUNwQkMsU0FBMkIsRUFDM0JDLFVBQXFEO0lBQUVDLFNBQVM7SUFBR0MsYUFBYTtBQUFJLENBQUM7SUFFckYsTUFBTSxFQUFFRCxPQUFPLEVBQUVDLGNBQWMsR0FBRyxFQUFFLEdBQUdGO0lBRXZDLElBQUlHO0lBQ0osSUFBSyxJQUFJQyxVQUFVLEdBQUdBLFdBQVdILFNBQVNHLFdBQVcsRUFBRztRQUN0RCxJQUFJO1lBQ0YsT0FBTyxNQUFNTDtRQUNmLEVBQUUsT0FBT00sT0FBTztZQUNkRixZQUFZRTtZQUNaLElBQUlELFlBQVlILFNBQVM7WUFDekIsTUFBTUssUUFBUUosY0FBY0ssS0FBS0MsR0FBRyxDQUFDLEdBQUdKO1lBQ3hDLE1BQU0sSUFBSUssUUFBUSxDQUFDQyxVQUFZQyxXQUFXRCxTQUFTSjtRQUNyRDtJQUNGO0lBRUEsTUFBTUg7QUFDUiIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpdGVfcmVhY3Rfc2hhZGNuX3RzLy4vc3JjL2xpYi9yZXRyeS50cz8zZDQxIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoUmV0cmllczxUPihcbiAgb3BlcmF0aW9uOiAoKSA9PiBQcm9taXNlPFQ+LFxuICBvcHRpb25zOiB7IHJldHJpZXM6IG51bWJlcjsgYmFzZURlbGF5TXM/OiBudW1iZXIgfSA9IHsgcmV0cmllczogMywgYmFzZURlbGF5TXM6IDUwMCB9XG4pOiBQcm9taXNlPFQ+IHtcbiAgY29uc3QgeyByZXRyaWVzLCBiYXNlRGVsYXlNcyA9IDUwMCB9ID0gb3B0aW9ucztcblxuICBsZXQgbGFzdEVycm9yOiB1bmtub3duO1xuICBmb3IgKGxldCBhdHRlbXB0ID0gMDsgYXR0ZW1wdCA8PSByZXRyaWVzOyBhdHRlbXB0ICs9IDEpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IG9wZXJhdGlvbigpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsYXN0RXJyb3IgPSBlcnJvcjtcbiAgICAgIGlmIChhdHRlbXB0ID09PSByZXRyaWVzKSBicmVhaztcbiAgICAgIGNvbnN0IGRlbGF5ID0gYmFzZURlbGF5TXMgKiBNYXRoLnBvdygyLCBhdHRlbXB0KTtcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XG4gICAgfVxuICB9XG5cbiAgdGhyb3cgbGFzdEVycm9yO1xufVxuIl0sIm5hbWVzIjpbIndpdGhSZXRyaWVzIiwib3BlcmF0aW9uIiwib3B0aW9ucyIsInJldHJpZXMiLCJiYXNlRGVsYXlNcyIsImxhc3RFcnJvciIsImF0dGVtcHQiLCJlcnJvciIsImRlbGF5IiwiTWF0aCIsInBvdyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/retry.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/vector.ts":
/*!***************************!*\
  !*** ./src/lib/vector.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   toPgVector: () => (/* binding */ toPgVector)\n/* harmony export */ });\nfunction toPgVector(embedding) {\n    const sanitized = embedding.map((value)=>{\n        if (!Number.isFinite(value)) {\n            throw new Error(\"Embedding contains non-finite values\");\n        }\n        return Number(value).toFixed(8);\n    });\n    return `[${sanitized.join(\",\")}]`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ZlY3Rvci50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQU8sU0FBU0EsV0FBV0MsU0FBbUI7SUFDNUMsTUFBTUMsWUFBWUQsVUFBVUUsR0FBRyxDQUFDLENBQUNDO1FBQy9CLElBQUksQ0FBQ0MsT0FBT0MsUUFBUSxDQUFDRixRQUFRO1lBQzNCLE1BQU0sSUFBSUcsTUFBTTtRQUNsQjtRQUNBLE9BQU9GLE9BQU9ELE9BQU9JLE9BQU8sQ0FBQztJQUMvQjtJQUVBLE9BQU8sQ0FBQyxDQUFDLEVBQUVOLFVBQVVPLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNuQyIsInNvdXJjZXMiOlsid2VicGFjazovL3ZpdGVfcmVhY3Rfc2hhZGNuX3RzLy4vc3JjL2xpYi92ZWN0b3IudHM/NWVlOSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gdG9QZ1ZlY3RvcihlbWJlZGRpbmc6IG51bWJlcltdKSB7XG4gIGNvbnN0IHNhbml0aXplZCA9IGVtYmVkZGluZy5tYXAoKHZhbHVlKSA9PiB7XG4gICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUodmFsdWUpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbWJlZGRpbmcgY29udGFpbnMgbm9uLWZpbml0ZSB2YWx1ZXNcIik7XG4gICAgfVxuICAgIHJldHVybiBOdW1iZXIodmFsdWUpLnRvRml4ZWQoOCk7XG4gIH0pO1xuXG4gIHJldHVybiBgWyR7c2FuaXRpemVkLmpvaW4oXCIsXCIpfV1gO1xufVxuIl0sIm5hbWVzIjpbInRvUGdWZWN0b3IiLCJlbWJlZGRpbmciLCJzYW5pdGl6ZWQiLCJtYXAiLCJ2YWx1ZSIsIk51bWJlciIsImlzRmluaXRlIiwiRXJyb3IiLCJ0b0ZpeGVkIiwiam9pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/vector.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/@prisma","vendor-chunks/postgres-array","vendor-chunks/zod","vendor-chunks/formdata-node","vendor-chunks/ms","vendor-chunks/@langchain","vendor-chunks/openai","vendor-chunks/node-fetch","vendor-chunks/langsmith","vendor-chunks/semver","vendor-chunks/web-streams-polyfill","vendor-chunks/zod-to-json-schema","vendor-chunks/event-target-shim","vendor-chunks/agentkeepalive","vendor-chunks/p-queue","vendor-chunks/form-data-encoder","vendor-chunks/eventemitter3","vendor-chunks/js-tiktoken","vendor-chunks/retry","vendor-chunks/base64-js","vendor-chunks/ansi-styles","vendor-chunks/abort-controller","vendor-chunks/camelcase","vendor-chunks/uuid","vendor-chunks/p-retry","vendor-chunks/p-timeout","vendor-chunks/humanize-ms","vendor-chunks/decamelize","vendor-chunks/p-finally"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fflashcards%2Froute&page=%2Fapi%2Fflashcards%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fflashcards%2Froute.ts&appDir=%2FUsers%2Fsania%2FPORJECT%2FMemorizeAI%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsania%2FPORJECT%2FMemorizeAI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();